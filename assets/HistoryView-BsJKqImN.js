import{_ as k,o as w,p as _,q,c as r,a as s,F as f,r as m,t as i,i as n,h as x,d as l,z as h,k as C,l as I}from"./index-D9BKMBNa.js";import{P as B}from"./ProductRow-Bq9a4zkS.js";import"./image-CPrgbr6F.js";const F={class:"history-container"},S={class:"filter-bar"},V=["onClick"],z={key:0,class:"loading-state"},M={key:1,class:"error"},N={key:2,class:"empty"},$={key:3,class:"order-list"},b={class:"card-header"},E={class:"order-id"},H={class:"time"},L={class:"total-row"},O={class:"card-footer"},P={__name:"HistoryView",setup(R){const d=n([]),u=n(!0),c=n(""),o=n("全部"),g=["全部","處理中","已發貨","已完成","已取消"],v=x(()=>o.value==="全部"?d.value:d.value.filter(t=>t.order_status===o.value));w(async()=>{try{_.profile||await _.init();const t=_.getUser();if(!t||!t.userId){c.value="無法取得使用者資訊，請重新登入",u.value=!1;return}const a=await q.getOrders(t.userId);a.data.status==="success"?d.value=a.data.data:c.value=a.data.message}catch(t){console.error(t),c.value="讀取失敗，請稍後再試"}finally{u.value=!1}});const y=t=>{switch(t){case"已完成":return"done";case"已發貨":return"shipped";case"已取消":return"cancelled";default:return"pending"}};return(t,a)=>(l(),r("div",F,[a[1]||(a[1]=s("h1",null,"我的訂單",-1)),s("div",S,[(l(),r(f,null,m(g,e=>s("button",{key:e,class:h(["filter-tab",{active:o.value===e}]),onClick:p=>o.value=e},i(e),11,V)),64))]),u.value?(l(),r("div",z,[...a[0]||(a[0]=[s("div",{class:"spinner"},null,-1),s("p",null,"載入中...",-1)])])):c.value?(l(),r("div",M,i(c.value),1)):v.value.length===0?(l(),r("div",N,i(o.value==="全部"?"尚無訂單記錄":`沒有「${o.value}」的訂單`),1)):(l(),r("div",$,[(l(!0),r(f,null,m(v.value,(e,p)=>(l(),r("div",{key:p,class:"order-card glass-card"},[s("div",b,[s("span",E,"#"+i(e.order_id),1),s("span",H,i(e.time),1)]),C(B,{image:e.image_url||"https://via.placeholder.com/200?text=No+Image",title:e.item_name,spec:e.spec,price:Math.round(e.total/e.qty),qty:e.qty,"image-size":200},{footer:I(()=>[s("div",L,"小計: $ "+i(e.total),1)]),_:2},1032,["image","title","spec","price","qty"]),s("div",O,[s("span",{class:h(["status-badge",y(e.order_status)])},i(e.order_status||"處理中"),3)])]))),128))]))]))}},U=k(P,[["__scopeId","data-v-761cba09"]]);export{U as default};
