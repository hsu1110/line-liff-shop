import{_ as k,x as c,o as b,c as d,b as s,F as p,r as v,a as _,s as u,k as m,p as I,f as o,t as g,g as O,D as w}from"./index-D49epYfD.js";import{P as A}from"./ProductRow-C_fRjQWN.js";import"./image-CPrgbr6F.js";const N={class:"admin-container"},q={class:"admin-header"},x={class:"header-actions"},B={key:0,class:"loading-state"},U={key:1,class:"order-list"},V={class:"group-header"},C={class:"order-no"},E={class:"user-name"},F={class:"items-list"},S={class:"group-footer"},D={class:"status-selector"},M=["value","onChange"],P={__name:"AdminOrderView",setup($){const l=m([]),i=m(!0);c.getUser()?.userId;const h=async()=>{i.value=!0;const t=c.getUser();try{const e=await _.adminGetAllOrders(t.userId);l.value=e.data.data}catch(e){console.error("Fetch admin orders error:",e),u("ç„¡æ³•å–å¾—è¨‚å–®åˆ—è¡¨","error")}finally{i.value=!1}},f=I(()=>{const t={};return!l.value||!Array.isArray(l.value)||l.value.forEach(e=>{t[e.orderId]||(t[e.orderId]=[]),t[e.orderId].push(e)}),t}),y=async(t,e)=>{const n=c.getUser();try{await _.adminUpdateOrder(n.userId,t,e),l.value.forEach(r=>{r.orderId===t&&(r.status=e)}),u("ç‹€æ…‹å·²æ›´æ–°","success")}catch{u("æ›´æ–°å¤±æ•—","error")}};return b(h),(t,e)=>(o(),d("div",N,[s("header",q,[e[1]||(e[1]=s("h1",null,"è¨‚å–®ç¸½è¦½ä¸­å¿ƒ",-1)),s("div",x,[s("button",{onClick:e[0]||(e[0]=n=>t.$router.push("/admin/products")),class:"sub-nav-btn"},"â† å•†å“ç®¡ç†")])]),i.value?(o(),d("div",B,[...e[2]||(e[2]=[s("div",{class:"spinner"},null,-1),s("p",null,"è¼‰å…¥ä¸­...",-1)])])):(o(),d("div",U,[(o(!0),d(p,null,v(f.value,(n,r)=>(o(),d("div",{key:r,class:"order-group glass-card"},[s("div",V,[s("span",C,"# "+g(r),1),s("span",E,"ğŸ‘¤ "+g(n[0].userName),1)]),s("div",F,[(o(!0),d(p,null,v(n,a=>(o(),O(A,{key:a.pid+a.spec,image:a.image_url||"https://via.placeholder.com/200?text=No+Image",title:a.productName,spec:a.spec,price:Math.round(a.total/a.qty),qty:a.qty,"image-size":150},null,8,["image","title","spec","price","qty"]))),128))]),s("div",S,[s("div",D,[s("select",{value:n[0].status,onChange:a=>y(r,a.target.value),class:"status-select"},[...e[3]||(e[3]=[w('<option value="æœªä»˜æ¬¾" data-v-369be215>æœªä»˜æ¬¾</option><option value="å·²ä»˜æ¬¾" data-v-369be215>å·²ä»˜æ¬¾</option><option value="å·²ç™¼è²¨" data-v-369be215>å·²ç™¼è²¨</option><option value="å·²å®Œæˆ" data-v-369be215>å·²å®Œæˆ</option><option value="å·²å–æ¶ˆ" data-v-369be215>å·²å–æ¶ˆ</option>',5)])],40,M)])])]))),128))]))]))}},R=k(P,[["__scopeId","data-v-369be215"]]);export{R as default};
