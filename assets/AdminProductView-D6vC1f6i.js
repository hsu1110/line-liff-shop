import{_ as g,y as l,o as k,c as n,b as t,F as A,r as p,a as u,l as m,f as o,u as y,t as c,h as L,j as r}from"./index-CRqdp2YD.js";import{o as b}from"./image-CPrgbr6F.js";const w={class:"admin-container"},I={class:"admin-header"},B={class:"header-actions"},P={key:0,class:"loading-state"},V={key:1,class:"product-list"},C={class:"card-main"},T=["src"],$={class:"info"},D={class:"price"},E={class:"card-actions"},S=["onClick"],U=["onClick"],x={__name:"AdminProductView",setup(z){const i=m([]),d=m(!0);l.getUser()?.userId;const v=async()=>{d.value=!0;try{const e=await u.getProducts();i.value=e.data.data}finally{d.value=!1}},h=async e=>{const a=e.status==="AVAILABLE"?"SOLD_OUT":"AVAILABLE",s=await l.getIDToken();try{await u.adminUpdateProduct(s,{...e,status:a}),e.status=a,r(`狀態已更新為 ${a}`,"success")}catch{r("更新失敗","error")}},f=async e=>{if(!confirm("確定要刪除此商品嗎？此操作無法復原。"))return;const a=await l.getIDToken();try{await u.adminDeleteProduct(a,e),i.value=i.value.filter(s=>s.pid!==e),r("商品已刪除","success")}catch{r("刪除失敗","error")}};return k(v),(e,a)=>(o(),n("div",w,[t("header",I,[a[1]||(a[1]=t("h1",null,"商品管理中心",-1)),t("div",B,[t("button",{onClick:a[0]||(a[0]=s=>e.$router.push("/admin/orders")),class:"sub-nav-btn"},"訂單管理 →")])]),d.value?(o(),n("div",P,[...a[2]||(a[2]=[t("div",{class:"spinner"},null,-1)])])):(o(),n("div",V,[(o(!0),n(A,null,p(i.value,s=>(o(),n("div",{key:s.pid,class:"admin-card glass-card"},[t("div",C,[t("img",{src:y(b)(s.image_url,200),class:"thumb"},null,8,T),t("div",$,[t("h3",null,c(s.name),1),t("p",D,"$ "+c(s.price),1),t("div",{class:L(["status-tag",s.status])},c(s.status==="AVAILABLE"?"上架中":"已售完"),3)])]),t("div",E,[t("button",{onClick:_=>h(s),class:"action-btn status"},c(s.status==="AVAILABLE"?"設為售完":"設為上架"),9,S),t("button",{onClick:_=>f(s.pid),class:"action-btn delete"},"刪除",8,U)])]))),128))]))]))}},j=g(x,[["__scopeId","data-v-5d229f51"]]);export{j as default};
