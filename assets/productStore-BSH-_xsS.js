import{G as e,q as i}from"./index-D9BKMBNa.js";const a=e("product",{state:()=>({products:[],lastFetchTime:0,loading:!1,error:null}),getters:{allProducts:t=>t.products,displayProducts:t=>t.products.filter(s=>s.status==="AVAILABLE"||s.status==="SOLD_OUT"),getProductByPid:t=>s=>t.products.find(o=>o.pid===s)},actions:{async fetchProducts(t=!1){const s=Date.now(),o=300*1e3;if(!t&&this.products.length>0&&s-this.lastFetchTime<o){console.log("Using cached products");return}this.loading=!0,this.error=null;try{const r=await i.getProducts();r.data&&r.data.status==="success"&&Array.isArray(r.data.data)&&(this.products=r.data.data,this.lastFetchTime=s)}catch(r){console.error("Fetch products error:",r),this.error="無法載入商品列表"}finally{this.loading=!1}},updateProductInStore(t){const s=this.products.findIndex(o=>o.pid===t.pid);s!==-1?this.products[s]={...this.products[s],...t}:this.products.unshift(t)},removeProductFromStore(t){this.products=this.products.filter(s=>s.pid!==t)}}});export{a as u};
