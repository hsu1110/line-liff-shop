import{_ as C,f as I,c as i,a as s,t as p,u as m,k as w,l as v,F as N,r as x,h as S,m as q,i as F,p as f,q as P,x as h,s as y,b as V,d as n,y as B,e as E}from"./index-C2ow85uB.js";import{P as $}from"./ProductRow-Cnr1Vkjq.js";import"./image-CPrgbr6F.js";const O={class:"cart-container"},R={class:"admin-header glass-card"},U={class:"stats-bar"},L={class:"stat-item"},T={class:"stat-value"},W={class:"stat-item"},z={class:"stat-value available"},D={key:0,class:"empty-cart glass-card"},K={key:1,class:"cart-list"},M=["onClick"],j={class:"checkout-footer glass-card"},A={class:"total-info"},G={class:"amount"},H=["disabled"],J={key:0},Q={key:1,class:"loading-dots"},X={__name:"CartView",setup(Y){const _=V(),e=I(),d=S(()=>e.items),c=F(!1);function b(a){e.removeFromCart(a)}async function g(){if(!(e.totalItems===0||c.value)){c.value=!0;try{const a=f.getUser(),t=a?.userId||"UNKNOWN_USER",u=a?.displayName||"æœªçŸ¥ä½¿ç”¨è€…",o={userId:t,userName:u,items:d.value.map(r=>({pid:r.pid,spec:r.spec,qty:r.qty}))},l=await P.submitOrder(o);if(l.data.status==="success"){const r=l.data.orderId;if(e.clearCart(),f.isInClient())try{await h.sendMessages([{type:"text",text:`æˆ‘å·²ä¸‹å–® #${r}`}]),h.closeWindow()}catch(k){console.error("LIFF Send Error:",k),_.push({name:"history"})}else y("è¨‚å–®å·²é€å‡ºï¼å–®è™Ÿ: "+r,"success"),_.push({name:"history"})}else throw new Error(l.data.message||"ä¸‹å–®å¤±æ•—")}catch(a){y("çµå¸³å¤±æ•—: "+a.message,"error")}finally{c.value=!1}}}return(a,t)=>{const u=q("router-link");return n(),i("div",O,[s("header",R,[t[3]||(t[3]=s("div",{class:"header-main"},[s("div",{class:"header-info"},[s("h1",null,"æˆ‘çš„è³¼ç‰©è»Š"),s("p",{class:"admin-subtitle"},"ç¢ºèªè³¼è²·å“é …èˆ‡é‡‘é¡")])],-1)),s("div",U,[s("div",L,[t[0]||(t[0]=s("span",{class:"stat-label"},"å•†å“æ•¸",-1)),s("span",T,p(m(e).totalItems),1)]),t[2]||(t[2]=s("div",{class:"stat-divider"},null,-1)),s("div",W,[t[1]||(t[1]=s("span",{class:"stat-label"},"é è¨ˆç¸½é¡",-1)),s("span",z,"$ "+p(m(e).totalPrice),1)])])]),d.value.length===0?(n(),i("div",D,[t[5]||(t[5]=s("div",{class:"icon"},"ğŸ›’",-1)),t[6]||(t[6]=s("p",null,"è³¼ç‰©è»Šç›®å‰ç©ºç©ºå¦‚ä¹Ÿ",-1)),w(u,{to:"/",class:"go-shop-btn"},{default:v(()=>[...t[4]||(t[4]=[B("å»é€›é€›",-1)])]),_:1})])):(n(),i("div",K,[(n(!0),i(N,null,x(d.value,(o,l)=>(n(),E($,{key:l,image:o.image_url,title:o.name,spec:o.spec,price:o.price,qty:o.qty,"image-size":200},{actions:v(()=>[s("button",{onClick:r=>b(l),class:"del-btn"},"ç§»é™¤",8,M)]),_:2},1032,["image","title","spec","price","qty"]))),128)),s("div",j,[s("div",A,[t[7]||(t[7]=s("span",{class:"label"},"æ‡‰ä»˜ç¸½é¡",-1)),s("span",G,"$ "+p(m(e).totalPrice),1)]),s("button",{onClick:g,class:"checkout-btn",disabled:c.value},[c.value?(n(),i("span",Q,"è™•ç†ä¸­")):(n(),i("span",J,"ç¢ºèªä¸‹å–®"))],8,H)])]))])}}},es=C(X,[["__scopeId","data-v-1c88f404"]]);export{es as default};
