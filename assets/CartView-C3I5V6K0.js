import{u as p}from"./cart-DmjcbRBe.js";import{a as m}from"./api-Bu7grN30.js";import{_ as f,c,a as e,F as h,r as v,t as n,g as y,h as k,l as o,d as i}from"./index-Txo-tZaC.js";const C={class:"cart-container"},g={key:0,class:"empty-cart"},I={key:1},w={class:"img"},b=["src"],S={class:"info"},x={class:"price-qty"},B=["onClick"],q={class:"footer"},E={class:"total"},N={__name:"CartView",setup(V){const a=p(),l=k(()=>a.items);function u(s){a.removeFromCart(s)}async function _(){if(a.totalItems!==0)try{let s="BROWSER_TEST_USER",r="Browser User";if(o.isInClient()){const t=await o.getProfile();s=t.userId,r=t.displayName}for(const t of l.value)await m.submitOrder({pid:t.pid,userId:s,userName:r,spec:t.spec,qty:t.qty});alert("訂單已送出！"),a.clearCart(),o.isInClient()&&o.sendMessages([{type:"text",text:"我已下單 (來自 V2 商城)"}]).then(()=>o.closeWindow()).catch(t=>{console.error(t),o.closeWindow()})}catch(s){alert("結帳失敗: "+s)}}return(s,r)=>(i(),c("div",C,[r[0]||(r[0]=e("h1",null,"購物車",-1)),l.value.length===0?(i(),c("div",g," 購物車是空的 ")):(i(),c("div",I,[(i(!0),c(h,null,v(l.value,(t,d)=>(i(),c("div",{key:d,class:"cart-item"},[e("div",w,[e("img",{src:t.image_url},null,8,b)]),e("div",S,[e("h3",null,n(t.name),1),e("p",null,n(t.spec),1),e("div",x,[e("span",null,"$ "+n(t.price),1),e("span",null,"x "+n(t.qty),1)]),e("button",{onClick:F=>u(d),class:"del-btn"},"移除",8,B)])]))),128)),e("div",q,[e("div",E,"總計: $ "+n(y(a).totalPrice),1),e("button",{onClick:_,class:"checkout-btn"},"送出訂單")])]))]))}},O=f(N,[["__scopeId","data-v-44b2e656"]]);export{O as default};
