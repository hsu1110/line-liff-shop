import{_ as k,o as w,x as _,a as x,c as r,b as s,F as f,r as m,t as o,k as n,p as C,f as l,A as h,l as I,m as q}from"./index-xhTKwg9a.js";import{P as B}from"./ProductRow-DV6F3Wy4.js";import"./image-CPrgbr6F.js";const F={class:"history-container"},S={class:"filter-bar"},V=["onClick"],b={key:0,class:"loading-state"},M={key:1,class:"error"},N={key:2,class:"empty"},$={key:3,class:"order-list"},z={class:"card-header"},A={class:"order-id"},E={class:"time"},H={class:"total-row"},L={class:"card-footer"},O={__name:"HistoryView",setup(P){const u=n([]),d=n(!0),c=n(""),i=n("全部"),g=["全部","處理中","已發貨","已完成","已取消"],v=C(()=>i.value==="全部"?u.value:u.value.filter(t=>t.order_status===i.value));w(async()=>{try{_.profile||await _.init();const t=_.getUser();if(!t||!t.userId){c.value="無法取得使用者資訊，請重新登入",d.value=!1;return}const a=await x.getOrders(t.userId);a.data.status==="success"?u.value=a.data.data:c.value=a.data.message}catch(t){console.error(t),c.value="讀取失敗，請稍後再試"}finally{d.value=!1}});const y=t=>{switch(t){case"已完成":return"done";case"已發貨":return"shipped";case"已取消":return"cancelled";default:return"pending"}};return(t,a)=>(l(),r("div",F,[a[1]||(a[1]=s("h1",null,"我的訂單",-1)),s("div",S,[(l(),r(f,null,m(g,e=>s("button",{key:e,class:h(["filter-tab",{active:i.value===e}]),onClick:p=>i.value=e},o(e),11,V)),64))]),d.value?(l(),r("div",b,[...a[0]||(a[0]=[s("div",{class:"spinner"},null,-1),s("p",null,"載入中...",-1)])])):c.value?(l(),r("div",M,o(c.value),1)):v.value.length===0?(l(),r("div",N,o(i.value==="全部"?"尚無訂單記錄":`沒有「${i.value}」的訂單`),1)):(l(),r("div",$,[(l(!0),r(f,null,m(v.value,(e,p)=>(l(),r("div",{key:p,class:"order-card glass-card"},[s("div",z,[s("span",A,"#"+o(e.order_id),1),s("span",E,o(e.time),1)]),I(B,{image:e.image_url||"https://via.placeholder.com/200?text=No+Image",title:e.item_name,spec:e.spec,price:Math.round(e.total/e.qty),qty:e.qty,"image-size":200},{footer:q(()=>[s("div",H,"小計: $ "+o(e.total),1)]),_:2},1032,["image","title","spec","price","qty"]),s("div",L,[s("span",{class:h(["status-badge",y(e.order_status)])},o(e.order_status||"處理中"),3)])]))),128))]))]))}},U=k(O,[["__scopeId","data-v-761cba09"]]);export{U as default};
