import{u as h}from"./cart-BRYtx1Fw.js";import{a as v}from"./api-lWrPAgcP.js";import{_ as y,c,a as t,F as I,r as k,t as n,h as C,i as g,l as i,u as w,e as l}from"./index-C-EbjIvV.js";const S={class:"cart-container"},b={key:0,class:"empty-cart"},x={key:1},B={class:"img"},E=["src"],F={class:"info"},R={class:"price-qty"},q=["onClick"],N={class:"footer"},$={class:"total"},O={__name:"CartView",setup(V){const _=w(),o=h(),d=g(()=>o.items);function m(r){o.removeFromCart(r)}async function f(){if(o.totalItems!==0)try{let r="BROWSER_TEST_USER",a="Browser User";if(i.isInClient()){const e=await i.getProfile();r=e.userId,a=e.displayName}let s=null;for(const e of d.value){const p=await v.submitOrder({pid:e.pid,userId:r,userName:a,spec:e.spec,qty:e.qty});p.status==="success"&&(s=p)}o.clearCart();const u=s.orderId;if(i.isInClient())try{await i.sendMessages([{type:"text",text:`我已下單 #${u}`}]),i.closeWindow()}catch(e){console.error("LIFF Send Error:",e),_.push({name:"history"})}else alert("訂單已送出！"),_.push({name:"history"})}catch(r){alert("結帳失敗: "+r)}}return(r,a)=>(l(),c("div",S,[a[0]||(a[0]=t("h1",null,"購物車",-1)),d.value.length===0?(l(),c("div",b," 購物車是空的 ")):(l(),c("div",x,[(l(!0),c(I,null,k(d.value,(s,u)=>(l(),c("div",{key:u,class:"cart-item"},[t("div",B,[t("img",{src:s.image_url},null,8,E)]),t("div",F,[t("h3",null,n(s.name),1),t("p",null,n(s.spec),1),t("div",R,[t("span",null,"$ "+n(s.price),1),t("span",null,"x "+n(s.qty),1)]),t("button",{onClick:e=>m(u),class:"del-btn"},"移除",8,q)])]))),128)),t("div",N,[t("div",$,"總計: $ "+n(C(o).totalPrice),1),t("button",{onClick:f,class:"checkout-btn"},"送出訂單")])]))]))}},U=y(O,[["__scopeId","data-v-b70ae338"]]);export{U as default};
