import{_ as C,x as v,o as I,c as l,b as e,F as _,r as m,a as h,s as f,k as c,p as w,f as o,A as B,t as g,g as F}from"./index-xhTKwg9a.js";import{P as q}from"./ProductRow-DV6F3Wy4.js";import"./image-CPrgbr6F.js";const x={class:"admin-container"},E={class:"admin-header"},N={class:"header-actions"},U={class:"filter-bar"},S=["onClick"],T={key:0,class:"loading-state"},V={key:1,class:"order-list"},$={class:"group-header"},z={class:"order-no"},L={class:"user-name"},M={class:"items-list"},P={class:"group-footer"},R={class:"status-selector"},b={key:0,class:"updating-status"},D=["value","onChange"],G={__name:"AdminOrderView",setup(j){const i=c([]),p=c(!0),u=c(null),d=c("å…¨éƒ¨"),y=["å…¨éƒ¨","è™•ç†ä¸­","å·²ç™¼è²¨","å·²å®Œæˆ","å·²å–æ¶ˆ"];v.getUser()?.userId;const k=async()=>{p.value=!0;const r=v.getUser();try{const s=await h.adminGetAllOrders(r.userId);i.value=s.data.data}catch(s){console.error("Fetch admin orders error:",s),f("ç„¡æ³•å–å¾—è¨‚å–®åˆ—è¡¨","error")}finally{p.value=!1}},A=w(()=>{const r={};return!i.value||!Array.isArray(i.value)||(d.value==="å…¨éƒ¨"?i.value:i.value.filter(t=>t.status===d.value)).forEach(t=>{r[t.orderId]||(r[t.orderId]=[]),r[t.orderId].push(t)}),r}),O=async(r,s)=>{if(u.value)return;u.value=r;const t=v.getUser();try{await h.adminUpdateOrder(t.userId,r,s),i.value.forEach(n=>{n.orderId===r&&(n.status=s)}),f("ç‹€æ…‹å·²æ›´æ–°","success")}catch{f("æ›´æ–°å¤±æ•—","error")}finally{u.value=null}};return I(k),(r,s)=>(o(),l("div",x,[e("header",E,[s[1]||(s[1]=e("h1",null,"è¨‚å–®ç¸½è¦½ä¸­å¿ƒ",-1)),e("div",N,[e("button",{onClick:s[0]||(s[0]=t=>r.$router.push("/admin/products")),class:"sub-nav-btn"},"â† å•†å“ç®¡ç†")])]),e("div",U,[(o(),l(_,null,m(y,t=>e("button",{key:t,class:B(["filter-tab",{active:d.value===t}]),onClick:n=>d.value=t},g(t),11,S)),64))]),p.value?(o(),l("div",T,[...s[2]||(s[2]=[e("div",{class:"spinner"},null,-1),e("p",null,"è¼‰å…¥ä¸­...",-1)])])):(o(),l("div",V,[(o(!0),l(_,null,m(A.value,(t,n)=>(o(),l("div",{key:n,class:"order-group glass-card"},[e("div",$,[e("span",z,"# "+g(n),1),e("span",L,"ğŸ‘¤ "+g(t[0].userName),1)]),e("div",M,[(o(!0),l(_,null,m(t,a=>(o(),F(q,{key:a.pid+a.spec,image:a.image_url||"https://via.placeholder.com/200?text=No+Image",title:a.productName,spec:a.spec,price:Math.round(a.total/a.qty),qty:a.qty,"image-size":150},null,8,["image","title","spec","price","qty"]))),128))]),e("div",P,[e("div",R,[u.value===n?(o(),l("div",b,[...s[3]||(s[3]=[e("div",{class:"mini-spinner"},null,-1),e("span",null,"æ›´æ–°ä¸­...",-1)])])):(o(),l("select",{key:1,value:t[0].status,onChange:a=>O(n,a.target.value),class:"status-select"},[...s[4]||(s[4]=[e("option",{value:"è™•ç†ä¸­"},"è™•ç†ä¸­",-1),e("option",{value:"å·²ç™¼è²¨"},"å·²ç™¼è²¨",-1),e("option",{value:"å·²å®Œæˆ"},"å·²å®Œæˆ",-1),e("option",{value:"å·²å–æ¶ˆ"},"å·²å–æ¶ˆ",-1)])],40,D))])])]))),128))]))]))}},Q=C(G,[["__scopeId","data-v-2daae90f"]]);export{Q as default};
